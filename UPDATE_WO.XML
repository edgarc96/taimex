<pre>

PicLan-IP/BASIC ^ ^
*
OPEN 'XMLDATA' TO XMLDATAF ELSE STOP 201,'XMLDATA'
OPEN 'WO' TO WOF ELSE STOP 201,'WO'

PL_GETVAR WORK_NUMBER FROM 'WORK_NUMBER' ELSE WORK_NUMBER = ''
PL_GETVAR WO_DATE FROM 'WO_DATE' ELSE WO_DATE = ''
PL_GETVAR WO_TYPE FROM 'WO_TYPE' ELSE WO_TYPE = ''
PL_GETVAR ASSY_NO FROM 'ASSY_NO' ELSE ASSY_NO = ''
PL_GETVAR SCHEDULE_DATE FROM 'SCHEDULE_DATE' ELSE SCHEDULE_DATE = ''
PL_GETVAR SCHEDULE_QTY FROM 'SCHEDULE_QTY' ELSE SCHEDULE_QTY = ''
PL_GETVAR ORD_QTY FROM 'ORD_QTY' ELSE ORD_QTY = ''
PL_GETVAR YIELD FROM 'YIELD' ELSE YIELD = ''
PL_GETVAR START_DATE FROM 'START_DATE' ELSE START_DATE = ''
PL_GETVAR NOTES FROM 'NOTES' ELSE NOTES = ''
PL_GETVAR ACTION FROM 'ACTION' ELSE ACTION = ''

PL_ADD_HDR '"Content-Type: application/xml"'

XML.RESPONSE = '<?xml version="1.0" encoding="UTF-8"?>'
XML.RESPONSE = XML.RESPONSE:'<WorkOrderSave>'
XML.RESPONSE = XML.RESPONSE:'<action>':ACTION:'</action>'
XML.RESPONSE = XML.RESPONSE:'<work_number>':WORK_NUMBER:'</work_number>'
XML.RESPONSE = XML.RESPONSE:'<schedule_date>':SCHEDULE_DATE:'</schedule_date>'
XML.RESPONSE = XML.RESPONSE:'<schedule_qty>':SCHEDULE_QTY:'</schedule_qty>'
XML.RESPONSE = XML.RESPONSE:'<start_date>':START_DATE:'</start_date>'
XML.RESPONSE = XML.RESPONSE:'<notes>':NOTES:'</notes>'

IF WORK_NUMBER = '' THEN
    XML.RESPONSE = XML.RESPONSE:'<status>ERROR</status>'
    XML.RESPONSE = XML.RESPONSE:'<message>Work Number required</message>'
    GOTO FINISH
END

* Build record with POST values
SCHEDULE_FIELD = SCHEDULE_DATE
IF SCHEDULE_QTY <> '' THEN
    SCHEDULE_FIELD = SCHEDULE_DATE:'*':SCHEDULE_QTY
END

WO.RECORD = ''
WO.RECORD<1> = WO_DATE
WO.RECORD<20> = WO_TYPE
WO.RECORD<25> = NOTES
WO.RECORD<32> = ASSY_NO
WO.RECORD<34> = SCHEDULE_FIELD
WO.RECORD<35> = ORD_QTY
WO.RECORD<36> = YIELD
WO.RECORD<104> = START_DATE

WRITE WO.RECORD ON WOF, WORK_NUMBER

XML.RESPONSE = XML.RESPONSE:'<status>SUCCESS</status>'
XML.RESPONSE = XML.RESPONSE:'<message>Work Order saved successfully</message>'
XML.RESPONSE = XML.RESPONSE:'<wo_id>':WORK_NUMBER:'</wo_id>'

FINISH:
XML.RESPONSE = XML.RESPONSE:'</WorkOrderSave>'

WRITE XML.RESPONSE ON XMLDATAF,'UPDATE_WO.XML'
ERR = ''
CALL PLW.PAGE('/XMLDATA/UPDATE_WO.XML','',ERR)
RETURN
</pre>