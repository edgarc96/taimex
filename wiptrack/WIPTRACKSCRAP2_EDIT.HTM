<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>WIP Tracking - Scrap Entry</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      height: 100%;
      width: 100%;
    }

    body {
      font-family: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
      color: #334155;
      min-height: 100vh;
    }

    .container {
      width: 100%;
      height: 100vh;
      background: #fff;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    .header {
      background: linear-gradient(135deg, #1e293b 0%, #1e3a8a 100%);
      color: #fff;
      padding: 8px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 2px 8px rgba(30, 41, 59, 0.25);
      position: relative;
      z-index: 100;
      width: 100%;
      flex-shrink: 0;
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 20px;
    }

    .logo-section img {
      height: 40px;
      width: auto;
      object-fit: contain;
      filter: brightness(1.05);
    }

    .title-section {
      text-align: right;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .title-row {
      display: flex;
      align-items: center;
      justify-content: flex-end;
      gap: 16px;
    }

    .welcome-user {
      white-space: nowrap;
      text-align: right;
    }

    .welcome-user span {
      color: #cbd5e1;
      font-size: 0.8em;
      font-weight: 400;
    }

    .welcome-user strong {
      color: #3b82f6;
      margin-left: 4px;
      font-weight: 600;
      font-size: 0.9em;
    }

    .title-section h2 {
      font-size: 1em;
      margin: 0;
      font-weight: 600;
      color: #f1f5f9;
      letter-spacing: 0.3px;
    }

    .title-section p {
      font-size: 0.8em;
      margin: 0;
      color: #a2a8ba;
    }

    .hamburger-menu {
      background: none;
      border: none;
      color: #fff;
      font-size: 1.2em;
      cursor: pointer;
      padding: 8px;
      border-radius: 6px;
      transition: background-color 0.2s ease;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }

    .hamburger-menu:hover {
      background-color: rgba(255, 255, 255, 0.12);
    }

    .hamburger-menu svg {
      width: 24px;
      height: 24px;
      fill: #fff;
    }

    .hamburger-menu svg path {
      fill: #fff;
    }

    .main-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      width: 100%;
      background: #f8fafc;
      height: calc(100vh - 60px);
    }

    .sidebar {
      position: fixed;
      top: 0;
      left: -300px;
      width: 300px;
      height: 100vh;
      background: rgba(255, 255, 255, 0.08);
      backdrop-filter: blur(1px);
      -webkit-backdrop-filter: blur(1px);
      color: #fff;
      transition: left 0.2s ease;
      z-index: 2000;
      box-shadow: 2px 0 12px rgba(0, 0, 0, 0.35);
      overflow: hidden;
    }

    .sidebar-header {
      padding: 20px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      background: rgba(255, 255, 255, 0.05);
    }

    .sidebar-header h3 {
      font-size: 1.1em;
      color: #fff;
      margin: 0;
    }

    .sidebar-content {
      padding: 24px;
    }

    .sidebar-menu {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .sidebar-menu li {
      margin-bottom: 10px;
    }

    .sidebar-menu label {
      display: block;
      padding: 12px 16px;
      color: #f3f4f6;
      text-decoration: none;
      border-radius: 8px;
      transition: all 0.2s ease;
      font-weight: 500;
      cursor: pointer;
    }

    .sidebar-menu label:hover {
      background-color: rgba(30, 64, 175, 0.12);
      color: #fff;
    }

    .sidebar-menu label.active {
      background-color: rgba(30, 64, 175, 0.25);
      color: #93c5fd;
    }

    .sidebar-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0, 0, 0, 0.55);
      opacity: 0;
      visibility: hidden;
      transition: all 0.25s ease;
      z-index: 1500;
      pointer-events: none;
    }

    #sb-toggle:checked ~ .sidebar {
      left: 0;
    }

    #sb-toggle:checked ~ .sidebar-overlay {
      opacity: 1;
      visibility: visible;
      pointer-events: auto;
    }

    #sb-toggle {
      position: absolute;
      left: -9999px;
    }

    .wip-wrapper {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 16px;
      padding: 16px;
      overflow: hidden;
      height: 100%;
    }

    .wip-card {
      background: #fff;
      border-radius: 12px;
      padding: 16px;
      box-shadow: 0 4px 12px rgba(15, 23, 42, 0.08);
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .section-title {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
    }

    .section-title h3 {
      font-size: 1.2em;
      color: #0f172a;
      font-weight: 600;
    }

    .section-title p {
      font-size: 0.9em;
      color: #64748b;
    }

    .action-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 8px 16px;
      border-radius: 999px;
      font-weight: 600;
      font-size: 0.9em;
      cursor: pointer;
      border: none;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .btn-primary {
      background: linear-gradient(135deg, #1d4ed8 0%, #1e3a8a 100%);
      color: #fff;
      box-shadow: 0 12px 24px rgba(29, 78, 216, 0.28);
    }

    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 16px 30px rgba(29, 78, 216, 0.35);
    }

    .btn-secondary {
      background: linear-gradient(135deg, #64748b 0%, #475569 100%);
      color: #fff;
      box-shadow: 0 10px 22px rgba(71, 85, 105, 0.25);
    }

    .btn-secondary:hover {
      transform: translateY(-1px);
      box-shadow: 0 14px 26px rgba(71, 85, 105, 0.32);
    }

    .btn-danger {
      background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
      color: #fff;
      box-shadow: 0 10px 22px rgba(185, 28, 28, 0.25);
    }

    .btn-danger:hover {
      transform: translateY(-1px);
      box-shadow: 0 14px 26px rgba(185, 28, 28, 0.32);
    }

    .process-box {
      background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
      border: 1px solid #bbf7d0;
      border-radius: 12px;
      padding: 20px;
      text-align: center;
      margin-bottom: 0;
      flex-shrink: 0;
    }

    .process-icon {
      font-size: 48px;
      color: #16a34a;
      margin-bottom: 16px;
    }

    .process-title {
      font-size: 22px;
      font-weight: 700;
      color: #15803d;
      margin-bottom: 8px;
    }

    .process-message {
      font-size: 14px;
      color: #64748b;
      margin-bottom: 0;
      line-height: 1.4;
    }

    .info-box {
      background: linear-gradient(135deg, #dbeafe 0%, #f0f9ff 100%);
      border: 1px solid #bfdbfe;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 24px;
      display: flex;
      gap: 12px;
    }

    .info-box-icon {
      font-size: 24px;
      color: #1e3a8a;
      flex-shrink: 0;
    }

    .info-box-content strong {
      display: block;
      color: #1e293b;
      font-weight: 600;
      margin-bottom: 6px;
      font-size: 16px;
    }

    .info-box-content p {
      color: #475569;
      font-size: 14px;
      line-height: 1.6;
      margin: 0;
    }

    .work-order-info {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin-top: 8px;
    }

    .info-item {
      background: rgba(255, 255, 255, 0.7);
      border-radius: 6px;
      padding: 8px 12px;
      display: flex;
      align-items: center;
      gap: 6px;
      flex: 1;
      min-width: 180px;
    }

    .info-item i {
      color: #1e3a8a;
      font-size: 18px;
    }

    .info-item .label {
      font-size: 0.85em;
      color: #64748b;
      font-weight: 500;
    }

    .info-item .value {
      font-size: 1em;
      color: #0f172a;
      font-weight: 600;
    }

    .form-group {
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin-bottom: 12px;
      text-align: left;
    }

    .form-group label {
      font-size: 0.9em;
      font-weight: 600;
      color: #1f2937;
      text-align: left;
    }

    .form-group input[type="text"],
    .form-group input[type="number"],
    .form-group select {
      padding: 8px 12px;
      border: 2px solid #e2e8f0;
      border-radius: 8px;
      font-size: 0.9em;
      transition: all 0.2s ease;
      background: #fff;
      color: #0f172a;
      width: 100%;
    }

    .form-group input:focus,
    .form-group select:focus {
      outline: none;
      border-color: #2563eb;
      box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.15);
    }

    .form-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 12px;
      margin-bottom: 16px;
    }

    .scrap-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 16px;
      background: #fff;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(15, 23, 42, 0.05);
    }

    .scrap-table th {
      background: #1e293b;
      color: #fff;
      padding: 10px 12px;
      text-align: left;
      font-weight: 600;
      font-size: 0.85em;
    }

    .scrap-table td {
      padding: 8px 12px;
      border-bottom: 1px solid #e2e8f0;
    }

    .scrap-table tr:last-child td {
      border-bottom: none;
    }

    .scrap-table tr:hover {
      background: #f8fafc;
    }

    .add-scrap-btn {
      background: linear-gradient(135deg, #10b981 0%, #059669 100%);
      color: #fff;
      border: none;
      padding: 8px 14px;
      border-radius: 6px;
      font-weight: 600;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      transition: all 0.2s ease;
      margin-bottom: 12px;
      font-size: 0.9em;
    }

    .add-scrap-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(16, 185, 129, 0.25);
    }

    .remove-scrap-btn {
      background: #ef4444;
      color: #fff;
      border: none;
      padding: 6px 10px;
      border-radius: 6px;
      font-size: 0.85em;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .remove-scrap-btn:hover {
      background: #dc2626;
    }

    .message-box {
      background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);
      border: 1px solid #fecaca;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 24px;
      display: flex;
      gap: 12px;
    }

    .message-box-icon {
      font-size: 24px;
      color: #dc2626;
      flex-shrink: 0;
    }

    .message-box-content {
      color: #991b1b;
      font-size: 14px;
      line-height: 1.6;
      margin: 0;
      font-weight: 500;
    }

    @media (max-width: 768px) {
      .header {
        flex-direction: column;
        align-items: flex-start;
        gap: 16px;
      }

      .title-section {
        text-align: left;
        align-items: flex-start;
      }

      .title-row {
        flex-direction: column;
        align-items: flex-start;
        gap: 6px;
      }

      .action-buttons {
        flex-direction: column;
        align-items: stretch;
      }

      .wip-wrapper {
        padding: 16px;
      }

      .process-box {
        padding: 24px 16px;
      }

      .process-title {
        font-size: 24px;
      }

      .work-order-info {
        flex-direction: column;
      }

      .info-item {
        min-width: auto;
      }

      .form-grid {
        grid-template-columns: 1fr;
      }

      .scrap-table {
        font-size: 0.9em;
      }

      .scrap-table th,
      .scrap-table td {
        padding: 12px;
      }
    }
  </style>
</head>
<body>
  <input type="checkbox" id="sb-toggle">
  <label for="sb-toggle" class="sidebar-overlay" aria-hidden="true"></label>

  <aside class="sidebar" aria-label="Main menu">
    <div class="sidebar-header">
      <h3>Menu</h3>
    </div>
    <div class="sidebar-content">
      <ul class="sidebar-menu">
        <li><label for="sb-toggle">Main Menu</label></li>
        <li><label for="sb-toggle">Parts Management</label></li>
        <li><label for="sb-toggle">Work Orders</label></li>
        <li><label for="sb-toggle">Sales Orders</label></li>
        <li><label for="sb-toggle">Stock Transactions</label></li>
        <li><label for="sb-toggle" class="active">WIP Tracking</label></li>
      </ul>
    </div>
  </aside>

  <div class="container">
    <header class="header">
      <div class="header-left">
        <label class="hamburger-menu" for="sb-toggle" aria-label="Open menu">
          <svg viewBox="0 0 448 512" role="img" aria-hidden="true" focusable="false" width="20" height="20">
            <path d="M0 96C0 78.3 14.3 64 32 64H416C433.7 64 448 78.3 448 96C448 113.7 433.7 128 416 128H32C14.3 128 0 113.7 0 96zM0 256C0 238.3 14.3 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.3 288 0 273.7 0 256zM448 416C448 433.7 433.7 448 416 448H32C14.3 448 0 433.7 0 416C0 398.3 14.3 384 32 384H416C433.7 384 448 398.3 448 416z"></path>
          </svg>
        </label>
        <div class="logo-section">
          <img src="http://54.189.226.145/uploads/assets/images/taimex_logo.png" alt="TAIMEX INDUSTRIAL" onerror="this.onerror=null;this.src='http://54.189.226.145/uploads/assets/images/taimex_logo.png';">
        </div>
      </div>
      <div class="title-section">
        <div class="title-row">
          <div class="welcome-user">
            <span>Welcome,</span>
            <strong id="currentUserDisplay">Operator</strong>
          </div>
          <div>
            <h2>TAIMEX - WIP TRACKING</h2>
            <p>TAIMEX - MANAGEMENT</p>
          </div>
        </div>
      </div>
    </header>

    <main class="main-content">
      <div class="wip-wrapper">
        <div style="max-width: 1000px; margin: 0 auto; width: 100%; height: 100%; display: flex; flex-direction: column;">
          <!-- Process Card -->
          <div class="process-box">
            <div class="process-icon">
              <i class="fas fa-recycle"></i>
            </div>
            <h1 class="process-title">WIP Tracking - Scrap Entry</h1>
            <p class="process-message">
              Enter scrap details for this work order operation. Record quantity and scrap codes as needed.
            </p>
          </div>

          <!-- Work Order Info -->
          <div class="wip-card">
            <div class="section-title">
              <h3>Work Order Information</h3>
            </div>
            <div class="work-order-info">
              <div class="info-item">
                <i class="fas fa-hashtag"></i>
                <div>
                  <div class="label">Work Order</div>
                  <div class="value">^WOID^</div>
                </div>
              </div>
              <div class="info-item">
                <i class="fas fa-cogs"></i>
                <div>
                  <div class="label">Assembly</div>
                  <div class="value">^ASSY^</div>
                </div>
              </div>
              <div class="info-item">
                <i class="fas fa-map-marker-alt"></i>
                <div>
                  <div class="label">Location</div>
                  <div class="value">^WLOC^ ^WLOCD^</div>
                </div>
              </div>
              <div class="info-item">
                <i class="fas fa-balance-scale"></i>
                <div>
                  <div class="label">WIP Balance</div>
                  <div class="value">^WIPQTY^</div>
                </div>
              </div>
            </div>
          </div>

          <!-- Scrap Entry Form -->
          <div class="wip-card">
            <div class="section-title">
              <h3>Scrap Entry</h3>
            </div>
            <form method="post" name="getpage" action="/WIPTRACKSCRAP2_EDIT.HTM">
              <div class="form-grid">
                <div class="form-group">
                  <label for="PASSQTY">
                    <i class="fas fa-check-circle" style="color: #2a5298; margin-right: 8px;"></i>
                    Quantity Passed:
                  </label>
                  <input name="PASSQTY" type="number" id="PASSQTY" value="^PASSQTY^" min="0" step="1">
                </div>
                
                <div class="form-group">
                  <label for="SCRAPQTY">
                    <i class="fas fa-exclamation-triangle" style="color: #2a5298; margin-right: 8px;"></i>
                    Scrap Quantity:
                  </label>
                  <input name="SCRAPQTY" type="number" id="SCRAPQTY" value="^SCRAPQTY^" min="0" step="1">
                </div>
              </div>
              
              <div class="form-group">
                <label for="NOTES">
                  <i class="fas fa-sticky-note" style="color: #2a5298; margin-right: 8px;"></i>
                  Notes:
                </label>
                <input name="NOTES" type="text" id="NOTES" value="^NOTES^" placeholder="Enter any notes for this operation">
              </div>
              
              <!-- Scrap Table -->
              <div class="scrap-table">
                <thead>
                  <tr>
                    <th>Scrap Code</th>
                    <th>Quantity</th>
                    <th>Reason</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <select name="SCRAPCODE1" id="SCRAPCODE1">
                        <option value="">Select Code</option>
                        <option value="01">01 - Material Defect</option>
                        <option value="02">02 - Operator Error</option>
                        <option value="03">03 - Equipment Failure</option>
                        <option value="04">04 - Process Issue</option>
                        <option value="05">05 - Quality Control</option>
                      </select>
                    </td>
                    <td>
                      <input name="SCRAPQTY1" type="number" id="SCRAPQTY1" value="^SCRAPQTY1^" min="0" step="1">
                    </td>
                    <td>
                      <input name="SCRAPREASON1" type="text" id="SCRAPREASON1" value="^SCRAPREASON1^" placeholder="Enter reason">
                    </td>
                    <td>
                      <button type="button" class="remove-scrap-btn">
                        <i class="fas fa-trash"></i> Remove
                      </button>
                    </td>
                  </tr>
                </tbody>
              </div>
              
              <button type="button" class="add-scrap-btn">
                <i class="fas fa-plus-circle"></i> Add Scrap Entry
              </button>
              
              <!-- Message Box -->
              <div class="message-box" id="messageBox" style="display: none;">
                <div class="message-box-icon">
                  <i class="fas fa-exclamation-triangle"></i>
                </div>
                <div class="message-box-content">
                  ^MSG^
                </div>
              </div>
              
              <!-- Action Buttons -->
              <div class="action-buttons" style="justify-content: center; margin-top: 12px;">
                <button 
                  type="submit" 
                  name="COMPLETE"
                  class="btn btn-primary">
                  <i class="fas fa-check-circle"></i>
                  Complete Operation
                </button>
                <button 
                  type="submit"
                  name="SUSPEND"
                  class="btn btn-secondary">
                  <i class="fas fa-pause-circle"></i>
                  Suspend
                </button>
                <button 
                  type="submit"
                  name="CANCEL"
                  class="btn btn-danger">
                  <i class="fas fa-times-circle"></i>
                  Cancel
                </button>
              </div>
            </form>
          </div>

          <!-- Info Box -->
          <div class="info-box" style="margin-top: auto; flex-shrink: 0;">
            <div class="info-box-icon">
              <i class="fas fa-info-circle"></i>
            </div>
            <div class="info-box-content">
              <strong>Scrap Entry Information</strong>
              <p>Enter the quantity passed and any scrap quantities for this operation. Select appropriate scrap codes and provide reasons for each scrap entry.</p>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <!-- Form with Hidden Fields -->
  <form method="post" name="getpage" action="/WIPTRACKSCRAP2_EDIT.HTM">
    <input name="BADGEID" type="hidden" value="^BADGEID^">
    <input name="WOID" type="hidden" value="^WOID^">
    <input name="ASSY" type="hidden" value="^ASSY^">
    <input name="WLOC" type="hidden" value="^WLOC^">
    <input name="WLOCD" type="hidden" value="^WLOCD^">
    <input name="WIPQTY" type="hidden" value="^WIPQTY^">
    <input name="PEOPLE" type="hidden" value="^PEOPLE^">
  </form>

  <div align="left">
  <pre>PicLan-IP/BASIC ^ ^
*
*     Initialize all variables
      MSG = ''
      ERR = ''
      BADGEID = ''
      UPDATE = ''
      WOID = ''
      PEOPLE = ''
      CANCEL = ''
      SUSPEND = ''
      COMPLETE = ''
      SCRAP1 = ''
      SCRAP2 = ''
      SCRAP3 = ''
      SCRAP4 = ''
      SCRAPQ1 = ''
      SCRAPQ2 = ''
      SCRAPQ3 = ''
      SCRAPQ4 = ''
      NOTES = ''
      SPLIT = ''
      PASSQTY = ''
      WIPQTY = ''
      SCRAPQTY = ''
      SCRAPQTY1 = ''
      SCRAPREASON1 = ''
      SCRAPCODE1 = ''
      WOREC = ''
      WIPLOCREC = ''
      WIPSTATUS = ''
      OPNO = ''
      OPDESC = ''
      LAST.STATUS = ''
      PERSON.CNT = ''
      ASSY = ''
      WLOC = ''
      WLOCD = ''
      ID = ''
      WONO = ''
      INIT = ''
      OPREC = ''
      OPERNAME = ''
      BOO = ''
      BOOSEQ = ''
      SCRAPSEL1 = ''
      SCRAPSEL2 = ''
      SCRAPSEL3 = ''
      SCRAPSEL4 = ''
      WIPS.REC = ''
      TSCRAP = ''
      PACKNG = ''
      WN = ''
      NWN = ''
      I = ''
      LI = ''
      LLI = ''
*
      PL_GETVAR BADGEID FROM 'BADGEID' ELSE BADGEID = ''
      PL_GETVAR UPDATE FROM 'UPDATE' ELSE UPDATE = ''
      PL_GETVAR WOID FROM 'WOID' ELSE WOID = ''
      PL_GETVAR PEOPLE FROM 'PEOPLE' ELSE PEOPLE = ''
      PL_GETVAR CANCEL FROM 'CANCEL' ELSE CANCEL = ''
      PL_GETVAR SUSPEND FROM 'SUSPEND' ELSE SUSPEND = ''
      PL_GETVAR COMPLETE FROM 'COMPLETE' ELSE COMPLETE = ''
      PL_GETVAR SCRAP1 FROM 'SCRAP1' ELSE SCRAP1 = ''
      PL_GETVAR SCRAP2 FROM 'SCRAP2' ELSE SCRAP2 = ''
      PL_GETVAR SCRAP3 FROM 'SCRAP3' ELSE SCRAP3 = ''
      PL_GETVAR SCRAP4 FROM 'SCRAP4' ELSE SCRAP4 = ''
      PL_GETVAR SCRAPQ1 FROM 'SCRAPQ1' ELSE SCRAPQ1 = ''
      PL_GETVAR SCRAPQ2 FROM 'SCRAPQ2' ELSE SCRAPQ2 = ''
      PL_GETVAR SCRAPQ3 FROM 'SCRAPQ3' ELSE SCRAPQ3 = ''
      PL_GETVAR SCRAPQ4 FROM 'SCRAPQ4' ELSE SCRAPQ4 = ''
      PL_GETVAR NOTES FROM 'NOTES' ELSE NOTES = ''
      PL_GETVAR SPLIT FROM 'SPLIT' ELSE SPLIT = ''
      PL_GETVAR PASSQTY FROM 'PASSQTY' ELSE PASSQTY = ''
      PL_GETVAR WIPQTY FROM 'WIPQTY' ELSE WIPQTY = ''
      PL_GETVAR SCRAPQTY FROM 'SCRAPQTY' ELSE SCRAPQTY = ''
      PL_GETVAR SCRAPQTY1 FROM 'SCRAPQTY1' ELSE SCRAPQTY1 = ''
      PL_GETVAR SCRAPREASON1 FROM 'SCRAPREASON1' ELSE SCRAPREASON1 = ''
      PL_GETVAR SCRAPCODE1 FROM 'SCRAPCODE1' ELSE SCRAPCODE1 = ''
*
      OPEN 'OPERS' TO OPERSF ELSE STOP 201,'OPERS'
      OPEN 'BADGES' TO BADGEF ELSE STOP 201,'BADGE'
      OPEN 'WO' TO WOF ELSE STOP 201,'WO'
      OPEN 'WIPLOC' TO WIPLOCF ELSE STOP 201,'WIPLOC'
      OPEN 'WIPSTATUS' TO WIPSTATUSF ELSE STOP 201,'WIPSTATUS'
      OPEN 'EOPS' TO EOPSF ELSE STOP 201,'EOPS'
      OPEN 'EBOO' TO EBOOF ELSE STOP 201,'EBOO'
      OPEN 'LIID' TO LIID.FILE ELSE STOP 201,'LIID'
      OPEN 'STOCK' TO STOCKF ELSE STOP 201,'STOCK'
      OPEN 'STOCKW' TO STOCKWF ELSE STOP 201,'STOCKW'
       OPEN 'SCRAPCODES'TO SCRAPCODESF ELSE STOP 201,'SCRAPCODES'

      PL_GETVAR OPNO FROM 'OPNO' ELSE OPNO = ''
      PL_GETVAR OPDESC FROM 'OPDESC' ELSE OPDESC = ''
      PL_GETVAR LAST.STATUS FROM 'LAST.STATUS' ELSE LAST.STATUS = ''
      PERSON.CNT = PEOPLE
 *
      IF CANCEL NE '' THEN
         ERR = ''
         BADGEID = ''
         WOID = ''
         CALL PLW.PAGE('WIPTRACK_EDIT.HTM','',ERR)
         RETURN
      END
      MSG = ''
      READ WOREC FROM WOF,WOID ELSE 
         ERR = 'INVALID WORK ORDER NUMBER .. ':WOID
         GOTO 99
      END
*
      ID = WOID ; WONO = WOID
      ASSY = WOREC<32>
      WLOC = WOREC<90,1>
      READ WIPLOCREC FROM WIPLOCF,WLOC ELSE WIPLOCREC = ''
      WLOCD = WIPLOCREC<1>
      WIPQTY = WOREC<91,1> 
      IF PASSQTY = '' THEN PASSQTY = WIPQTY   
*
      INIT = FIELD(BADGEID,'|',1)
      READ OPREC FROM OPERSF,INIT ELSE
         MSG = 'INVALID OPERS INITIALS :':INIT
         GOTO 99
      END
      OPERNAME = OPREC<1>
     READ WIPSTATUS FROM WIPSTATUSF,WONO ELSE WIPSTATUS = ''
      OPNO = WIPSTATUS<16,DCOUNT(WIPSTATUS<16>,VM)>
      READV OPDESC FROM EOPSF,OPNO,1 ELSE OPDESC = ''
      LAST.STATUS = 'New'
      IF WIPSTATUS<1> = 'P' THEN LAST.STATUS = 'Paused'
      IF WIPSTATUS<1> = 'O' THEN LAST.STATUS = 'In Progress'

     BOOSEQ = ''
      READ BOO FROM EBOOF,WOREC<32> ELSE BOO = ''
      FOR I = 1 TO DCOUNT(BOO<14>,VM)
          WN = BOO<14,I>
          NWN = BOO<14,I+1>
          IF NWN EQ '' THEN
             BOOSEQ<1,-1> = WN
          END ELSE
             IF WN NE NWN THEN
               BOOSEQ<1,-1> = WN
             END
          END
      NEXT I
      BOO<14> = BOOSEQ



      SCRAPSEL1 = '' ; SCRAPSEL2 = '' ; SCRAPSEL3 = '' ; SCRAPSEL4 = ''
      CALL BUILDSCRAPCODESEL(SCRAPSEL1,'','SCRAP1',WLOC)
      CALL BUILDSCRAPCODESEL(SCRAPSEL2,'','SCRAP2',WLOC)
      CALL BUILDSCRAPCODESEL(SCRAPSEL3,'','SCRAP3',WLOC)
      CALL BUILDSCRAPCODESEL(SCRAPSEL4,'','SCRAP4',WLOC)
      READ WIPS.REC FROM WIPSTATUSF,WONO ELSE WIPS.REC = ''
*
      IF COMPLETE NE ''  THEN
           WOID = TRIM(WOID)
           WOID = OCONV(WOID,'MCU')
           READ WOREC FROM WOF,WOID ELSE WOREC = ''
           PL_GETVAR PEOPLE FROM 'PEOPLE' ELSE PEOPLE = 1
           PL_GETVAR SCRAP1 FROM 'SCRAP1' ELSE SCRAP1 = ''
           PL_GETVAR SCRAP2 FROM 'SCRAP2' ELSE SCRAP2 = ''
           PL_GETVAR SCRAP3 FROM 'SCRAP3' ELSE SCRAP3 = ''
           PL_GETVAR SCRAP4 FROM 'SCRAP4' ELSE SCRAP4 = ''
           PL_GETVAR SCRAPQ1 FROM 'SCRAPQ1' ELSE SCRAPQ1 = ''
           PL_GETVAR SCRAPQ2 FROM 'SCRAPQ2' ELSE SCRAPQ2 = ''
           PL_GETVAR SCRAPQ3 FROM 'SCRAPQ3' ELSE SCRAPQ3 = ''
           PL_GETVAR SCRAPQ4 FROM 'SCRAPQ4' ELSE SCRAPQ4 = ''
           PL_GETVAR NOTES FROM 'NOTES' ELSE NOTES = ''
           PL_GETVAR PASSQTY FROM 'PASSQTY' ELSE PASSQTY = ''
           PRINT 'SCRAPQ1 = ':SCRAPQ1
           PRINT 'SCRAPQ2 = ':SCRAPQ2
           PRINT 'SCRAPQ3 = ':SCRAPQ3
           PRINT 'SCRAPQ4 = ':SCRAPQ4
           PERSON.CNT = PEOPLE
           ERR = ''
           IF SCRAPQ1 NE '' AND NOT(NUM(SCRAPQ1)) THEN
                ERR<-1> = 'INVALID SCRAP1 COUNT ..'
           END
           IF SCRAPQ1 NE '' AND SCRAP1 = '[SCRAPCODE' THEN
               ERR<-1> = 'NEED SCRAP REASON 1'
           END
           IF SCRAPQ2 NE '' AND NOT(NUM(SCRAPQ2)) THEN
               ERR<-1> = 'INVALID SCRAP2 COUNT ..'
           END
           IF SCRAPQ2 NE '' AND SCRAP2 = '[SCRAPCODE' THEN
               ERR<-1> = 'NEED SCRAP REASON 2'
            END
           IF SCRAPQ3 NE '' AND NOT(NUM(SCRAPQ3)) THEN
              PRINT 'SCRAPQ3 = ':SCRAPQ3
              PRINT 'NUM SCRAPQ3 =':NUM(SCRAPQ3)
                ERR<-1> = 'INVALID SCRAP3 COUNT ..'
           END

           IF SCRAPQ3 NE '' AND SCRAP3 = '[SCRAPCODE' THEN
               ERR<-1> = 'NEED SCRAP REASON 3'
           END
           IF SCRAPQ4 NE '' AND NOT(NUM(SCRAPQ4)) THEN
                 ERR<-1> = 'INVALID SCRAP4 COUNT ..'   
           END
           IF SCRAPQ4 NE '' AND SCRAP4 = '[SCRAPCODE' THEN
               ERR<-1> = 'NEED SCRAP REASON 4'
           END


           
           TSCRAP = SCRAPQ1 + SCRAPQ2 + SCRAPQ3 + SCRAPQ4
           IF WLOC = 'A120' OR WLOC = 'A130' THEN PACKNG = 1 ELSE PACKNG = ''
*           IF WLOC NE 'A120' THEN
            IF PACKNG = '' THEN
             IF (WIPQTY - TSCRAP) NE PASSQTY THEN
                  IF SPLIT = '' THEN
                     ERR<-1> = 'WIP QTY - TOTAL SCRAP NOT EQUAL TO PASS.QTY'   
                  END          
              END
           END
           IF ERR NE '' THEN GOTO 99
*
           PL_PUTVAR WOID IN 'WOID' ELSE ERR = ''
           PL_PUTVAR ASSY IN 'ASSY' ELSE ERR = ''
           PL_PUTVAR WLOC IN 'WLOC' ELSE ERR = ''
           PL_PUTVAR WLOCD IN 'WLOCD' ELSE ERR = ''
           PL_PUTVAR PASSQTY IN 'PASSQTY' ELSE ERR = ''
           PL_PUTVAR NOTES IN 'NOTES' ELSE ERR = ''
           PL_PUTVAR TSCRAP IN 'TSCRAP' ELSE ERR = ''
           PL_PUTVAR SPLIT IN 'SPLIT' ELSE ERR = ''
           IF SCRAP1[1,1] = '[' THEN SCRAP1 = ''
           IF SCRAP2[1,1] = '[' THEN SCRAP2 = ''
           IF SCRAP3[1,1] = '[' THEN SCRAP3 = ''
           IF SCRAP4[1,1] = '[' THEN SCRAP4 = ''
           PL_PUTVAR SCRAP1 IN 'SCRAP1' ELSE ERR = ''
           PL_PUTVAR SCRAP2 IN 'SCRAP2' ELSE ERR = ''
           PL_PUTVAR SCRAP3 IN 'SCRAP3' ELSE ERR = ''
           PL_PUTVAR SCRAP4 IN 'SCRAP4' ELSE ERR = ''
           PL_PUTVAR SCRAPQ1 IN 'SCRAPQ1' ELSE ERR = ''
           PL_PUTVAR SCRAPQ2 IN 'SCRAPQ2' ELSE ERR = ''
           PL_PUTVAR SCRAPQ3 IN 'SCRAPQ3' ELSE ERR = ''
           PL_PUTVAR SCRAPQ4 IN 'SCRAPQ4' ELSE ERR = ''
           PL_PUTVAR SCRAPQTY IN 'SCRAPQTY' ELSE ERR = ''
           PL_PUTVAR SCRAPQTY1 IN 'SCRAPQTY1' ELSE ERR = ''
           PL_PUTVAR SCRAPREASON1 IN 'SCRAPREASON1' ELSE ERR = ''
           PL_PUTVAR SCRAPCODE1 IN 'SCRAPCODE1' ELSE ERR = ''
           PL_PUTVAR PEOPLE IN 'PEOPLE' ELSE ERR = ''
           PL_PUTVAR BADGEID IN 'BADGEID' ELSE ERR = ''
           PL_PUTVAR '' IN 'COMPLETE' ELSE ERR = ''
           PL_PUTVAR '' IN 'CANCEL' ELSE ERR = ''
           ERR = ''
           CALL PLW.PAGE('WIPTRACKREVIEW_EDIT.HTM','',ERR)
           RETURN
    END
*
99 *
  MSG = ERR
  MSG = PL_AMTOCRLF(MSG)
*
*
</pre>

  </div>
</body>
</html>